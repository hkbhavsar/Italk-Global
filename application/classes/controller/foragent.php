<?php defined('SYSPATH') or die('No direct script access.');  class Controller_Foragent extends Controller_Layout {        	public function before(){             parent::before();                        $styles = array(            'css/help_css/help.css' => 'screen'            );             $scripts = array(             'js/help_js/jquery_002.js',             'js/help_js/highlight.js',            );             $this->template->styles = array_merge($this->template->styles, $styles);             $this->template->scripts = array_merge($this->template->scripts, $scripts);	     $this->template->set_filename('layout/admin');	}	  	public function __construct(Request $request)	{		if (Auth::instance()->logged_in('',$all_required=false) == 0) {                             Request::current()->redirect('/auth/signin');                }		// Assign the request to the controller    		parent::__construct($request);	}	public function action_index()	{                $this->request->redirect($this->request->uri(                        array('action' => 'newpayday')), 301);	}       	public function action_newpayday($id=false)	{            if(isset($_POST['submit']) && $_POST['fname']!=''){                if(isset($id))                    $objLeads_Newpayday = ORM::factory('paydaylead',$id);                else                    $objLeads_Newpayday = ORM::factory('paydaylead');                $objLeads_Newpayday->fname = $_POST['fname'];                $objLeads_Newpayday->lname = $_POST['lname'];                $objLeads_Newpayday->phone = $_POST['phone'];                $objLeads_Newpayday->address = $_POST['address'];                $objLeads_Newpayday->city = $_POST['city'];                $objLeads_Newpayday->state = $_POST['state'];                $objLeads_Newpayday->zip = $_POST['zip'];                $objLeads_Newpayday->email = $_POST['email'];                $objLeads_Newpayday->dob = date('Y-m-d',strtotime($_POST['dob']));                $objLeads_Newpayday->ssn = $_POST['ssn'];                $objLeads_Newpayday->uin = $_POST['uin'];                $objLeads_Newpayday->comment = $_POST['comment'];                $objLeads_Newpayday->agent_id = Auth::instance()->get_user()->id;                $objLeads_Newpayday->loan_amount = $_POST['loan_amount'];                $objLeads_Newpayday->interest_rate_12 = $_POST['intrest_12'];                $objLeads_Newpayday->interest_rate_24 = $_POST['intrest_24'];                $objLeads_Newpayday->interest_rate_36 = $_POST['intrest_36'];                $objLeads_Newpayday->installments_month_12 = $_POST['install_12'];                $objLeads_Newpayday->installments_month_24 = $_POST['install_24'];                $objLeads_Newpayday->installments_month_36 = $_POST['install_36'];                $objLeads_Newpayday->advance_balance  = $_POST['advance_balance'];				                $objLeads_Newpayday->lead_reminder = date('Y-m-d',strtotime($_POST['followupdate']));                $objLeads_Newpayday->loan_transfered = $_POST['loan_transfered'];				if($id=='')                {                    $objLeads_Newpayday->c_date = date('Y-m-d h:i:s');                }                $objLeads_Newpayday->save();                $_POST = '';                                if(isset($id) && $id!='')                    $lead_edit = 1;                 else                 {                     $process_done = 1;                     $lead_edit = 0;                 }            }                        if(isset($id) && $id!='')            {                $objLeads_Newpayday_data = ORM::factory('paydaylead',$id);                           }            $this->template->title = "Submit Leads";            $this->template->clientData = $clientData;            $this->template->content = View::factory('agent/forpayday')                                        ->bind('pagging_links',$page_links_pagging_customer)                                        ->bind('callcenterData',$callcenterData)                                        ->bind('agentData',$agentData)                                        ->bind('clientData',$clientData)                                        ->bind('lead_type', $lead_type)                                        ->bind('process_done', $process_done)                                        ->bind('edit_newpayday', $objLeads_Newpayday_data)                                        ->bind('lead_edit', $lead_edit)                                                            ->bind('leadsData',$leadsData);	}    public function action_auto($id=false)	{                   if(isset($_POST['submit']) && $_POST['fname']!=''){                if(isset($id))                    $objLeads_auto = ORM::factory('leadauto',$id);                else                    $objLeads_auto = ORM::factory('leadauto');                $objLeads_auto->fname = $_POST['fname'];                $objLeads_auto->lname = $_POST['lname'];                $objLeads_auto->phone = $_POST['phone'];                $objLeads_auto->address = $_POST['address'];                $objLeads_auto->city = $_POST['city'];                $objLeads_auto->state = $_POST['state'];                $objLeads_auto->zip = $_POST['zip'];                $objLeads_auto->email = $_POST['email'];                $objLeads_auto->birth_date = date('Y-m-d',strtotime($_POST['dob']));                $objLeads_auto->ssn = $_POST['ssn'];                $objLeads_auto->monthly_income = $_POST['monthly_income'];                $objLeads_auto->rent_own = $_POST['rent'];                $objLeads_auto->agent_id = Auth::instance()->get_user()->id;                $objLeads_auto->year_residence = $_POST['resi_year'];                $objLeads_auto->month_residence = $_POST['resi_month'];                $objLeads_auto->rent_payment = $_POST['rent_mortgage'];                $objLeads_auto->bankruptcy = $_POST['bankruptcy'];                $objLeads_auto->employer = $_POST['employer'];                $objLeads_auto->job_title = $_POST['job_title'];                $objLeads_auto->work_number = $_POST['work_number'];                $objLeads_auto->year_with_company  = $_POST['company_year'];                $objLeads_auto->month_with_company = $_POST['company_month'];                $objLeads_auto->cosigner = $_POST['cosigner'];                $objLeads_auto->loan_amount = $_POST['loan_amount'];                $objLeads_auto->credit_check = $_POST['credit_chk'];                $objLeads_auto->down_payment = $_POST['down_payment'];                $objLeads_auto->credit_score = $_POST['credit_rating'];                $objLeads_auto->time_to_contact = $_POST['best_time_contact'];                $objLeads_auto->ip_address = $_POST['ip_address'];                $objLeads_auto->comment = $_POST['comment'];                $objLeads_auto->cosigner = $_POST['cosigner'];                $objLeads_auto->cosigner = $_POST['cosigner'];                         $objLeads_auto->c_date = date('Y-m-d h:i:s');                $objLeads_auto->save();                $_POST = '';                $process_done = 1;            }                        if(isset($id) && $id!='')            {                $objLeads_Newpayday_data = ORM::factory('paydaylead',$id);                $lead_edit = 1;            }            $this->template->title = "Submit Leads";            $this->template->clientData = $clientData;            $this->template->content = View::factory('agent/auto')                                        ->bind('pagging_links',$page_links_pagging_customer)                                        ->bind('callcenterData',$callcenterData)                                        ->bind('agentData',$agentData)                                        ->bind('clientData',$clientData)                                        ->bind('lead_type', $lead_type)                                        ->bind('process_done', $process_done)                                        ->bind('edit_newpayday', $objLeads_Newpayday_data)                                        ->bind('lead_edit', $lead_edit)                                                            ->bind('leadsData',$leadsData);	}	 public function action_new($id=false)	{            $objmake = ORM::factory('make');            $makeData = $objmake->find_all();            if(isset($_POST['submit']) && $_POST['fname']!=''){                if(isset($id))                    $objLeads_NewCar = ORM::factory('newcar',$id);                else                    $objLeads_NewCar = ORM::factory('newcar');                $objLeads_NewCar->fname = $_POST['fname'];                $objLeads_NewCar->lname = $_POST['lname'];                $objLeads_NewCar->phone = $_POST['phone'];                $objLeads_NewCar->address = $_POST['address'];                $objLeads_NewCar->city = $_POST['city'];                $objLeads_NewCar->state = $_POST['state'];                $objLeads_NewCar->zip = $_POST['zip'];                $objLeads_NewCar->email = $_POST['email'];                $objLeads_NewCar->make = $_POST['makename'];                $objLeads_NewCar->model = $_POST['model'];                $objLeads_NewCar->trim = $_POST['trim'];                $objLeads_NewCar->agent_id = Auth::instance()->get_user()->id;                $objLeads_NewCar->time_to_contact = $_POST['best_time_contact'];                $objLeads_NewCar->ip_address = $_POST['ip_address'];                $objLeads_NewCar->comments = $_POST['comment'];                $objLeads_NewCar->c_date = date('Y-m-d h:i:s');                $objLeads_NewCar->save();                $_POST = '';                if(isset($id) && $id!='')				{	                    $lead_edit = 1;				}				 else				 {					 $process_done = 1;					 $lead_edit = 0;				 }            }                        if(isset($id) && $id!='')            {                $objLeads_Newpayday_data = ORM::factory('paydaylead',$id);                            }            $this->template->title = "Submit Leads";            $this->template->clientData = $clientData;            $this->template->content = View::factory('agent/new')                                        ->bind('pagging_links',$page_links_pagging_customer)                                        ->bind('callcenterData',$callcenterData)                                        ->bind('agentData',$agentData)                                        ->bind('clientData',$clientData)                                        ->bind('lead_type', $lead_type)                                        ->bind('process_done', $process_done)                                        ->bind('edit_newpayday', $objLeads_Newpayday_data)                                        ->bind('lead_edit', $lead_edit)                                        ->bind('makeData', $makeData)                                        ->bind('leadsData',$leadsData);	}		 public function action_payday($id=false)	{             //echo "<pre>";             //print_r($_POST);exit;            if(isset($_POST['submit']) && $_POST['fname']!=''){                              if(isset($id))                    $objLeads_payday = ORM::factory('payday',$id);                else                    $objLeads_payday = ORM::factory('payday');                                list($m,$d,$y) = explode('/',$_POST['dob']);                list($m_payday1,$d_payday1,$y_payday1) = explode('/',$_POST['paydate_1']);                list($m_payday2,$d_payday2,$y_payday2) = explode('/',$_POST['paydate_2']);                                $birthday = $y.'-'.$m.'-'.$d;                 $pay_date1 = $y_payday1."/".$m_payday1."/".$d_payday1;                $pay_date2 = $y_payday2."/".$m_payday2."/".$d_payday2;                $objLeads_payday->lead_types = 'Payday';                $objLeads_payday->callcenter = 1;                               $objLeads_payday->fname = $_POST['fname'];                $objLeads_payday->lname = $_POST['lname'];                $objLeads_payday->gender = $_POST['gender'];                $objLeads_payday->phone = $_POST['phone'];                //$objLeads_payday->mobile = $_POST['paydate_1'];                $objLeads_payday->work_phone =  $_POST['employer_phone'];                $objLeads_payday->residence_years =  $_POST['resi_year'];                $objLeads_payday->residence_months =  $_POST['resi_month'];                $objLeads_payday->residence_type =  $_POST['rent_own'];                $objLeads_payday->ssn =  $_POST['ssn'];                $objLeads_payday->driving_license =  $_POST['driving_license'];                $objLeads_payday->state_issued_id =  $_POST['state_issue_id'];                $objLeads_payday->military =  $_POST['military'];                $objLeads_payday->loan_amount =  $_POST['loan_amount'];                $objLeads_payday->income_type = $_POST['income_type'];                $objLeads_payday->monthly_income =  $_POST['monthly_income'];                $objLeads_payday->income_frequency = $_POST['income_frequency'];                $objLeads_payday->income_direct_deposit =  $_POST['salary_direct_deposit'];                $objLeads_payday->pay_date1 =  $pay_date1;                $objLeads_payday->pay_date2 =  $pay_date2;                $objLeads_payday->zip =  $_POST['zip'];                $objLeads_payday->address =  $_POST['address'];                $objLeads_payday->city =  $_POST['city'];                $objLeads_payday->state =  $_POST['state'];                $objLeads_payday->employer_name = $_POST['employer'];                $objLeads_payday->employer_year =  $_POST['company_year'];                $objLeads_payday->employer_months =  $_POST['company_month'];                $objLeads_payday->employer_phone =  $_POST['employer_phone'];                $objLeads_payday->email =  $_POST['email'];                $objLeads_payday->dob = $birthday;                $objLeads_payday->ip_address =  $_POST['phone'];                $objLeads_payday->client_url  =  $_POST['phone'];                $objLeads_payday->bank_name  =  $_POST['bank_name'];                $objLeads_payday->bank_phone  =  $_POST['bank_phone'];                $objLeads_payday->bank_years  =  $_POST['bank_year'];                $objLeads_payday->job_title   =  $_POST['phone'];                $objLeads_payday->bank_account_type   =  $_POST['bank_account_type'];                $objLeads_payday->bank_account_number   =  $_POST['bank_acc'];                $objLeads_payday->bank_aba    =  $_POST['bank_routing'];                $objLeads_payday->best_call_time    =  $_POST['best_time_contact'];                $objLeads_payday->reference_name1    =  $_POST['ref_1'];                $objLeads_payday->reference_phone1   =  $_POST['ref_1_phone'];                $objLeads_payday->reference_relationship1    =  $_POST['ref_1_relation'];                $objLeads_payday->reference_name2    =  $_POST['ref_2'];                $objLeads_payday->reference_phone2   =  $_POST['ref_2_phone'];                $objLeads_payday->reference_relationship2  =  $_POST['ref_2_relation'];                $objLeads_payday->agent_id = Auth::instance()->get_user()->id;                $objLeads_payday->shift_hrs = $_POST['shift_hrs'];                $objLeads_payday->employer_zip = $_POST['employer_zip'];                $objLeads_payday->employer_state = $_POST['employer_state'];                $objLeads_payday->employer_city = $_POST['employer_city'];                $objLeads_payday->employer_address = $_POST['employer_address'];                $objLeads_payday->job_title = $_POST['job_title'];                $objLeads_payday->save();                $_POST = '';                if(isset($id) && $id!='')				{	                    $lead_edit = 1;				}                 else                 {                     $process_done = 1;                     $lead_edit = 0;                 }            }                        if(isset($id) && $id!='')            {                $objLeads_Newpayday_data = ORM::factory('paydaylead',$id);            }            $this->template->title = "Submit Leads";            $this->template->clientData = $clientData;            $this->template->content = View::factory('agent/payday')                                        ->bind('pagging_links',$page_links_pagging_customer)                                        ->bind('callcenterData',$callcenterData)                                        ->bind('agentData',$agentData)                                        ->bind('clientData',$clientData)                                        ->bind('lead_type', $lead_type)                                        ->bind('process_done', $process_done)                                        ->bind('edit_newpayday', $objLeads_Newpayday_data)                                        ->bind('lead_edit', $lead_edit)										->bind('leadsData',$leadsData);	}		public function action_diabitic($id=false)	{                   if(isset($_POST['submit']) && $_POST['fname']!=''){				                if(isset($id))                    $objLeads_auto = ORM::factory('diabiticauto',$id);                else                    $objLeads_auto = ORM::factory('diabiticauto');                $objLeads_auto->fname = $_POST['fname'];                $objLeads_auto->lname = $_POST['lname'];                $objLeads_auto->phone = $_POST['phone'];                $objLeads_auto->address = $_POST['address'];                $objLeads_auto->city = $_POST['city'];                $objLeads_auto->state = $_POST['state'];                $objLeads_auto->zip = $_POST['zip'];                $objLeads_auto->email = $_POST['email'];                $objLeads_auto->dob = date('Y-m-d',strtotime($_POST['dob']));                $objLeads_auto->hip_replacement_year = $_POST['hip_replacement_year'];                $objLeads_auto->hip_replacement_mfg = $_POST['hip_replacement_mfg'];                $objLeads_auto->hip_replacement_model = $_POST['hip_replacement_model'];                $objLeads_auto->agent_id = Auth::instance()->get_user()->id;				$objLeads_auto->hip_replacement_complications = $_POST['hip_replacement_complications'];                $objLeads_auto->hip_replacement_revision = $_POST['hip_replacement_revision'];                $objLeads_auto->hip_summary = $_POST['hip_summary'];				$objLeads_auto->best_time_contact = $_POST['best_time_contact'];                $objLeads_auto->c_date = date('Y-m-d');                $objLeads_auto->save();                $_POST = '';                $process_done = 1;            }                        if(isset($id) && $id!='')            {                $objLeads_Newpayday_data = ORM::factory('paydaylead',$id);                $lead_edit = 1;            }            $this->template->title = "Submit Leads";            $this->template->clientData = $clientData;            $this->template->content = View::factory('agent/diabitic')                                        ->bind('pagging_links',$page_links_pagging_customer)                                        ->bind('callcenterData',$callcenterData)                                        ->bind('agentData',$agentData)                                        ->bind('clientData',$clientData)                                        ->bind('lead_type', $lead_type)                                        ->bind('process_done', $process_done)                                        ->bind('edit_newpayday', $objLeads_Newpayday_data)                                        ->bind('lead_edit', $lead_edit)                                                            ->bind('leadsData',$leadsData);	}		public function action_insurance($id=false)	{            $objmake = ORM::factory('make');            $makeData = $objmake->find_all();            if(isset($_POST['submit']) && $_POST['fname']!=''){                if(isset($id))                    $objLeads_NewCar = ORM::factory('newcar',$id);                else                    $objLeads_NewCar = ORM::factory('newcar');                $objLeads_NewCar->fname = $_POST['fname'];                $objLeads_NewCar->lname = $_POST['lname'];                $objLeads_NewCar->phone = $_POST['phone'];                $objLeads_NewCar->address = $_POST['address'];                $objLeads_NewCar->city = $_POST['city'];                $objLeads_NewCar->state = $_POST['state'];                $objLeads_NewCar->zip = $_POST['zip'];                $objLeads_NewCar->email = $_POST['email'];                $objLeads_NewCar->make = $_POST['makename'];                $objLeads_NewCar->model = $_POST['model'];                $objLeads_NewCar->trim = $_POST['trim'];                $objLeads_NewCar->agent_id = Auth::instance()->get_user()->id;                $objLeads_NewCar->time_to_contact = $_POST['best_time_contact'];                $objLeads_NewCar->ip_address = $_POST['ip_address'];                $objLeads_NewCar->comments = $_POST['comment'];                $objLeads_NewCar->c_date = date('Y-m-d h:i:s');                $objLeads_NewCar->save();                $_POST = '';                if(isset($id) && $id!='')				{	                    $lead_edit = 1;				}				 else				 {					 $process_done = 1;					 $lead_edit = 0;				 }            }                        if(isset($id) && $id!='')            {                $objLeads_Newpayday_data = ORM::factory('paydaylead',$id);                            }            $this->template->title = "Submit Leads";            $this->template->clientData = $clientData;            $this->template->content = View::factory('agent/insurance')                                        ->bind('pagging_links',$page_links_pagging_customer)                                        ->bind('callcenterData',$callcenterData)                                        ->bind('agentData',$agentData)                                        ->bind('clientData',$clientData)                                        ->bind('lead_type', $lead_type)                                        ->bind('process_done', $process_done)                                        ->bind('edit_newpayday', $objLeads_Newpayday_data)                                        ->bind('lead_edit', $lead_edit)                                        ->bind('makeData', $makeData)                                        ->bind('leadsData',$leadsData);	}		        } // End Welcome